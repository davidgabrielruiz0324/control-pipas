<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Registro de suministro</title>
</head>

<body>

<h2>Registro de suministro</h2>

<p><strong>ID cliente:</strong> <span id="idTxt"></span></p>
<p><strong>Nombre:</strong> <span id="nombreTxt">---</span></p>

<form id="f">
  <input type="hidden" id="id_cliente">
  <input type="hidden" id="nombre_cliente">

  <label>Estatus:</label><br>
  <select id="estatus">
    <option value="ENTREGADO">ENTREGADO</option>
    <option value="NO SURTIDO">NO SURTIDO</option>
  </select><br><br>

  <label>Litros:</label><br>
  <input type="number" id="litros" value="0"><br><br>

  <label>Operador:</label><br>
  <input type="text" id="operador" required><br><br>

  <button type="submit">GUARDAR</button>
</form>

<script>
const params = new URLSearchParams(location.search);
const id = params.get("id");

idTxt.textContent = id;
id_cliente.value = id;

// CONSULTAR NOMBRE
fetch("https://script.google.com/macros/s/AKfycbzqd-7-gwJX_yu1n1HvTo8lpABsclmDu8hHelI0aFx0rlP01Yhs3k7e8pUGuFbWasXnEg/exec
  .then(r => r.json())
  .then(d => {
    nombreTxt.textContent = d.nombre || "---";
    nombre_cliente.value = d.nombre || "";
  });

document.getElementById("f").onsubmit = e => {
  e.preventDefault();

  fetch("https://script.google.com/macros/s/AKfycbzqd-7-gwJX_yu1n1HvTo8lpABsclmDu8hHelI0aFx0rlP01Yhs3k7e8pUGuFbWasXnEg/exec", {
    method: "POST",
    body: JSON.stringify({
      id: id,
      nombre: nombre_cliente.value,
      estatus: estatus.value,
      litros: litros.value,
      operador: operador.value
    })
  })
  .then(r => r.text())
  .then(() => alert("âœ… Registro guardado"));
};
</script>

</body>
</html>
